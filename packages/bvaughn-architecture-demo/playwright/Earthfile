VERSION 0.6

install:
    FROM  mcr.microsoft.com/playwright:v1.22.0-focal
    RUN yarn set version 3.2.1
    COPY . /playwright
    WORKDIR /playwright
    RUN yarn install
    RUN yarn playwright:install
    EXPOSE 3000

playwright:
    ARG --required HOST
    FROM +install
    ENV HOST $HOST
    RUN yarn test

playwright-update-snapshots:
    ARG --required HOST
    FROM +install
    ENV HOST $HOST
    RUN yarn test --update-snapshots
    SAVE ARTIFACT ./snapshots AS LOCAL ./snapshots